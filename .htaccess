# Force HTTPS
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{HTTP:X-Forwarded-Proto} =http
    RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L]
</IfModule>

# Enable CORS for all origins and security headers
<IfModule mod_headers.c>
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Methods "GET, POST, OPTIONS"
    Header set Access-Control-Allow-Headers "Content-Type"
    # Force HTTPS and prevent downgrade attacks
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
    # Upgrade any HTTP resources to HTTPS
    Header always set Content-Security-Policy "upgrade-insecure-requests"
</IfModule>

# Set proper MIME types
<IfModule mod_mime.c>
    AddType application/json .json
    AddType text/plain .txt
</IfModule>
